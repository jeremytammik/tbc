<p><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="bc.css">
<script src="run_prettify.js" type="text/javascript"></script>
<!--
<script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js" type="text/javascript"></script>
-->
</head></p>
<!---

What's New in the Revit 2017.1 API #REVITAPI @AutodeskRevit #aec #bim #dynamobim @AutodeskForge @adskdevnetwrk

I recently mentioned the updated Revit 2017.1 SDK and its API enhancements. They are documented in full detail in the section <i>Major additions to the 2017.1 Revit API</i> of the Revit 2017.1 API help file <code>RevitAPI.chm</code> included with the SDK, which is also provided there in the separate stand-alone document <i>Revit Platform API Changes and Additions.docx</i>. For convenient, easy and effective web searching, here is the online version of that information...

-->

<h3>What's New in the Revit 2017.1 API</h3>
<p>I recently mentioned the
updated <a href="http://thebuildingcoder.typepad.com/blog/2016/10/au-revit-20171-and-rex-freezedrawing.html#4">Revit 2017.1 SDK</a> and
its API enhancements.</p>
<p>They are documented in full detail in the section <em>Major additions to the 2017.1 Revit API</em> of the Revit 2017.1 API help file <code>RevitAPI.chm</code> included with the SDK, which is also provided there in the separate stand-alone document <em>Revit Platform API Changes and Additions.docx</em>.</p>
<p>For convenient, easy and effective web searching, here is the online version of that information.</p>
<p>I am only including that specific section here.</p>
<p>The rest of the document contents are identical with the original information
about <a href="http://thebuildingcoder.typepad.com/blog/2016/04/whats-new-in-the-revit-2017-api.html">What's New in the Revit 2017 API</a> provided
with the initial release of the Revit 2017 API.</p>
<p>I made one small enhancement to that existing blog post as well, though:</p>
<h4><a name="2"></a>Small Addendum to What's New in the Revit 2017 API</h4>
<p>I just <a href="https://github.com/jeremytammik/tbc/commit/b530c96b219422e9bc76eaf7698113fce4cf4968">made a small modification</a>,
adding the following note to <a href="http://thebuildingcoder.typepad.com/blog/2016/04/whats-new-in-the-revit-2017-api.html">What's New in the Revit 2017 API</a>:</p>
<ul>
<li><a href="http://thebuildingcoder.typepad.com/blog/2016/04/whats-new-in-the-revit-2017-api.html#2.9.2">TextNote creation behaviour change</a>
&ndash; The various <code>TextNote.Create</code> methods now need to be followed by a call to <code>Document.Regenerate</code> before the newly created <code>TextNote</code> can be queried for data.</li>
</ul>
<p>It was missing in the version I originally published.
I don't know when it slunk in there without me noticing.</p>
<h4><a name="3"></a>More About What's New</h4>
<p>The <em>What's New</em> section always provides very important information, both for discovering and exploring the newly added API functionality and for later reference.</p>
<p>If you encounter any issues migrating your existing add-ins between different versions, this is one of the first ports of call.</p>
<p>Here are links to the preceding 'What's New in the API' discussions:</p>
<ul>
<li><a href="http://thebuildingcoder.typepad.com/blog/2013/02/whats-new-in-the-revit-2010-api.html">What's New in the Revit 2010 API</a></li>
<li><a href="http://thebuildingcoder.typepad.com/blog/2013/02/whats-new-in-the-revit-2011-api.html">What's New in the Revit 2011 API</a></li>
<li><a href="http://thebuildingcoder.typepad.com/blog/2013/02/whats-new-in-the-revit-2012-api.html">What's New in the Revit 2012 API</a></li>
<li><a href="http://thebuildingcoder.typepad.com/blog/2013/03/whats-new-in-the-revit-2013-api.html">What's New in the Revit 2013 API</a></li>
<li><a href="http://thebuildingcoder.typepad.com/blog/2013/04/whats-new-in-the-revit-2014-api.html">What's New in the Revit 2014 API</a></li>
<li><a href="http://thebuildingcoder.typepad.com/blog/2014/04/whats-new-in-the-revit-2015-api.html">What's New in the Revit 2015 API</a></li>
<li><a href="http://thebuildingcoder.typepad.com/blog/2015/04/whats-new-in-the-revit-2016-api.html">What's New in the Revit 2016 API</a></li>
<li><a href="http://thebuildingcoder.typepad.com/blog/2016/04/whats-new-in-the-revit-2017-api.html">What's New in the Revit 2017 API</a></li>
</ul>
<p>For more detailed information, please refer to the complete API documentation and samples collection in the SDK and the
online <a href="http://help.autodesk.com/view/RVT/2017/ENU/?guid=GUID-F0A122E0-E556-4D0D-9D0F-7E72A9315A42">Revit API Developers Guide</a> provided
as part of the <a href="http://help.autodesk.com/view/RVT/2017/ENU">Revit 2017 Help</a>.</p>
<h3><a name="4"></a>Major Additions to the 2017.1 Revit API</h3>
<ul>
<li><a href="#4.1">API enabled in perspective views</a><ul>
<li><a href="#4.1.1">Element modifications and contextual commands</a></li>
<li><a href="#4.1.2">External commands and applications</a></li>
</ul>
</li>
<li><a href="#4.2">Geometry API additions</a><ul>
<li><a href="#4.2.1">BRepBuilder API additions</a></li>
<li><a href="#4.2.2">BRepBuilderSurfaceGeometry API additions</a></li>
<li><a href="#4.2.3">Ellipse API additions</a></li>
<li><a href="#4.2.4">RevolvedSurface API additions</a></li>
</ul>
</li>
<li><a href="#4.3">Dimension API additions</a><ul>
<li><a href="#4.3.1">DimensionEqualityLabelFormating API</a></li>
<li><a href="#4.3.2">UnitsFormatOptions in DimensionType</a></li>
<li><a href="#4.3.3">OrdinateDimensionSetting</a></li>
</ul>
</li>
<li><a href="#4.4">FabricationPart detailing API</a><ul>
<li><a href="#4.4.1">Split Parts API</a></li>
<li><a href="#4.4.2">Detailed Fabrication additions</a></li>
<li><a href="#4.4.3">Ancillary usage additions</a></li>
<li><a href="#4.4.4">Part status</a></li>
<li><a href="#4.4.5">Hanger rod additions</a></li>
</ul>
</li>
<li><a href="#4.5">Import API additions</a><ul>
<li><a href="#4.5.1">ShapeImporter additions</a></li>
</ul>
</li>
<li><a href="#4.6">Worksharing events addition</a><ul>
<li><a href="#4.6.1">WorksharedOperationProgressChangedEventArgs</a></li>
<li><a href="#4.6.2">DocumentSaveToLocalProgessChangedEventArgs</a></li>
<li><a href="#4.6.3">DocumentReloadLatestProgressChangedEventArgs</a></li>
<li><a href="#4.6.4">DocumentSaveToCentralProgessChangedEventArgs</a></li>
</ul>
</li>
</ul>
<h3><a name="4.1"></a>API enabled in perspective views</h3>
<h4><a name="4.1.1"></a>Element modifications and contextual commands</h4>
<p>Modification of many different object types is now allowed in perspective views. Most commands allowed in 3D orthographic views are now also allowed in perspective views. This includes contextual commands. Annotations are an exception and cannot be created in perspective views.</p>
<h4><a name="4.1.2"></a>External commands and applications</h4>
<p>External API commands and applications are now enabled by default in perspective views. The following behaviour applies:</p>
<ul>
<li>Any external command that was automatically disabled by Revit when a perspective view is active will now be active. No code changes are necessary to make this happen.</li>
<li>Any external command that was explicitly disabled in perspective views will remain disabled. For example, if your command has an accessibility function limiting it to use in certain view types, the command will not be accessible in perspective views unless that function accepts ViewType.ThreeD as a view type that is allowed.</li>
<li>Macros, the Macro Manager tools, Dynamo scripts and the Dynamo editor are also newly enabled when a perspective view is active.</li>
</ul>
<h3><a name="4.2"></a>Geometry API additions</h3>
<h4><a name="4.2.1"></a>BRepBuilder API additions</h4>
<p>Two new methods have been added to handle problematic faces:</p>
<ul>
<li>BRepBuilder.AllowRemovalOfProblematicFaces() &ndash; Allows BRepBuilder to remove problematic faces (e.g., due to inaccurate edge geometry).</li>
<li>BRepBuilder.RemovedSomeFaces() &ndash; Returns true if BRepBuilder removed some problematic faces from the output geometry.
One new method has been added to relax validation criteria on the input geometry:</li>
<li>BRepBuilder.SetAllowShortEdges() &ndash; Makes the BRepBuilder allow edges that it would normally disallow as being too short for Revit geometry.</li>
</ul>
<h4><a name="4.2.2"></a>BRepBuilderSurfaceGeometry API additions</h4>
<p>A new overload of the method:</p>
<ul>
<li>static BRepBuilderSurfaceGeometry.CreateNURBSSurface()</li>
</ul>
<p>constructs a BRepBuilderSurfaceGeometry based on NURBS surface data, where the weights are not supplied.</p>
<h4><a name="4.2.3"></a>Ellipse API additions</h4>
<p>The new method:</p>
<ul>
<li>static Ellipse.CreateCurve()</li>
</ul>
<p>creates a new geometric ellipse or elliptical arc object.</p>
<h4><a name="4.2.4"></a>RevolvedSurface API additions</h4>
<p>The new method:</p>
<ul>
<li>RevolvedSurface.GetProfileCurveInWorldCoordinates()</li>
</ul>
<p>returns a copy of the profile curve expressed in the world coordinate system.</p>
<h3><a name="4.3"></a>Dimension API additions</h3>
<h4><a name="4.3.1"></a>DimensionEqualityLabelFormating API</h4>
<p>The new class:</p>
<ul>
<li>DimensionEqualityLabelFormatting</li>
</ul>
<p>allows users to set dimension equality formulas for continuous linear or angular dimensions.</p>
<p>New methods and properties include:</p>
<ul>
<li>DimensionEqualityLabelFormatting.LeadingSpaces</li>
<li>DimensionEqualityLabelFormatting.LabelType</li>
<li>DimensionEqualityLabelFormatting.Prefix</li>
<li>DimensionEqualityLabelFormatting.Suffix</li>
<li>DimensionEqualityLabelFormatting.GetFormatOptions()</li>
<li>DimensionEqualityLabelFormatting.SetFormatOptions()</li>
</ul>
<p>The following new methods in DimensionType allow access to equality formulas:</p>
<ul>
<li>DimensionType.GetEqualityFormula()</li>
<li>DimensionType.SetEqualityFormula()</li>
</ul>
<h4><a name="4.3.2"></a>UnitsFormatOptions in DimensionType</h4>
<p>The new functions:</p>
<ul>
<li>DimensionType.GetUnitsFormatOptions()</li>
<li>DimensionType.SetUnitsFormatOptions()</li>
</ul>
<p>allow users to get or set the FormatOptions for a DimensionType.</p>
<h4><a name="4.3.3"></a>OrdinateDimensionSetting</h4>
<p>The new class:</p>
<ul>
<li>OrdinateDimensionSetting</li>
</ul>
<p>allows users to customize ordinate dimensions.</p>
<p>The new enum:</p>
<ul>
<li>OrdinateDimensionLineStyle</li>
</ul>
<p>allows users to choose continuous or segmented line styles for their dimensions.</p>
<p>The new enums:</p>
<ul>
<li>OrdinateTextOrientation</li>
<li>OrdinateTextPosition</li>
</ul>
<p>allows users to orient text in relation to the dimension lines or witness lines.</p>
<p>The new enum:</p>
<ul>
<li>OrdinateOriginVisibility</li>
</ul>
<p>allows users to control visibility of their dimensions.</p>
<p>New properties in OrdinateDimensionSetting include:</p>
<ul>
<li>OrdinateDimensionSetting.DimLineLength</li>
<li>OrdinateDimensionSetting.DimLineStyle</li>
<li>OrdinateDimensionSetting.TextOrientation</li>
<li>OrdinateDimensionSetting.TextPosition</li>
<li>OrdinateDimensionSetting.OriginVisibility</li>
<li>OrdinateDimensionSetting.OriginTickMarkId</li>
</ul>
<p>The following new methods in DimensionType allow access to the OrdinateDimensionSetting:</p>
<ul>
<li>DimensionType.GetOrdinateDimensionSetting()</li>
<li>DimensionType.SetOrdinateDimensionSetting()</li>
</ul>
<h3><a name="4.4"></a>FabricationPart detailing API</h3>
<h4><a name="4.4.1"></a>Split Parts API</h4>
<p>The following methods have been added to support splitting fabrication parts:</p>
<ul>
<li>FabricationPart.SplitStraight() &ndash; Splits the straight into two at the passed in point.</li>
<li>FabricationPart.IsStraightSegment() &ndash; Validates if the part is a straight.</li>
<li>FabricationPart.CanSplitStraight() &ndash; Validates if the straight can be split into two at the passed in point.</li>
</ul>
<h4><a name="4.4.2"></a>Detailed Fabrication additions</h4>
<p>Several methods, properties classes and enumerations have been added to allow the user to access detailed fabrication information defined in the fabrication configuration and in use on the fabrication parts.</p>
<p>The following methods allow access fabrication data defined by the currently loaded fabrication configuration. These can be used to query what fabrication data is available for fabrication parts to use:</p>
<ul>
<li>FabricationConfiguration.GetAllDampers() &ndash; Lists all damper identifiers.</li>
<li>FabricationConfiguration.GetDamperName() &ndash; Gets damper name from its identifier.</li>
<li>FabricationConfiguration.GetAncillaries() &ndash; Lists all ancillary identifiers (by enumerated type).</li>
<li>FabricationConfiguration.GetAncillaryName() &ndash; Gets ancillary name from its identifier.</li>
<li>FabricationConfiguration.GetAllPartStatuses() &ndash; Lists all part status identifiers.</li>
<li>FabricationConfiguration.GetPartStatusDescription() &ndash; Gets part status description from its identifier.</li>
<li>FabricationConfiguration.GetAllPartCustomData() &ndash; Lists all part custom data identifiers.</li>
<li>FabricationConfiguration.GetPartCustomDataName() &ndash; Gets part custom data name from its identifier.</li>
<li>FabricationConfiguration.GetPartCustomDataType() &ndash; Gets part custom data type enumeration from its identifier.</li>
</ul>
<p>The following methods allow access to Fabrication Part custom data defined per part (for querying and changing values):</p>
<ul>
<li>FabricationPart.HasCustomData() &ndash; Queries if a part has a certain optional custom data.</li>
<li>FabricationPart.Get/SetPartCustomDataText/Integer/Real() &ndash; Gets or sets fabrication part's custom data.</li>
<li>FabricationPart.Add/RemovePartCustomData() &ndash; Adds or removes optional custom data on fabrication parts.</li>
</ul>
<p>Added a new API to override routing exclusions</p>
<ul>
<li>FabricationService.IsGroupExcluded() &ndash; Gets whether a service group is excluded from routing.</li>
<li>FabricationService.SetServiceGroupExclusions() &ndash; Sets the service group exclusions.</li>
<li>FabricationService.ResetServiceExclusionOverrides() &ndash; Resets the overridden service group and button exclusions back to default.</li>
<li>FabricationService.OverrideServiceButtonExclusion() &ndash; Overrides the default service button exclusions.</li>
<li>FabricationServiceButton.IsExcluded() &ndash; Gets if the service button is excluded from routing.</li>
</ul>
<h4><a name="4.4.3"></a>Ancillary usage additions</h4>
<p>A method was added to query fabrication part ancillary usage. This method can be used to populate cut lists and procure ancillaries needed to fabricate and install the fabrication part:</p>
<ul>
<li>FabricationPart.GetPartAncillaryUsage() &ndash; Gets a list of FabricationAncillaryUsage structures that lists the
ancillaries that the fabrication part uses.</li>
</ul>
<p>The ancillary usage is held in a new class:</p>
<ul>
<li>FabricationAncillaryUsage</li>
</ul>
<p>It has the following read-only properties:</p>
<ul>
<li>FabricationAncillaryUsage.Type &ndash; A new enumerated type FabricationAncillaryType which describes what kind of ancillary it is (e.g., a fixing, airturn vane or support material).</li>
<li>FabricationAncillaryUsage.UsageType &ndash; A new enumerated type FabricationAncillaryUsageType describing the usage of the ancillary (e.g., in a support, connector or airturn).</li>
<li>FabricationAncillaryUsage.AncillaryId &ndash; The ancillary database identifier as listed by FabricationConfiguration.GetAncillaries().</li>
<li>FabricationAncillaryUsage.AncillaryWidthOrDiameter &ndash; The width / diameter of the ancillary (e.g., rod thickness).</li>
<li>FabricationAncillaryUsage.AncillaryDepth &ndash; The depth/height of the ancillary.</li>
<li>FabricationAncillaryUsage.Quantity &ndash; The quantity of the ancillary in this part.</li>
<li>FabricationAncillaryUsage.Length &ndash; The total length of the ancillary, if applicable, in this part.</li>
<li>FabricationAncillaryUsage.ProductCode &ndash; The product code identifier used to procure the ancillary.</li>
</ul>
<h4><a name="4.4.4"></a>Part status</h4>
<p>Two properties were added to fabrication part to allow the user to query and set the part fabrication status field:</p>
<ul>
<li>FabricationPart.PartStatus &ndash; Query and change the part fabrication status field current value. Setting the value will track when it was changed.</li>
<li>FabricationPart.PartGuid &ndash; Query the part's fabrication globally unique identifier, as used in applications such as Tracker.</li>
</ul>
<h4><a name="4.4.5"></a>Hanger rod additions</h4>
<p>To give the user better control over hanger rod thicknesses a new property was added to fabrication part to get and set the ancillary kit used:</p>
<ul>
<li>FabricationPart.HangerRodKit &ndash; get/set support rod kit override.</li>
</ul>
<h3><a name="4.5"></a>Import API additions</h3>
<h4><a name="4.5.1"></a>ShapeImporter additions</h4>
<p>Two new methods:</p>
<ul>
<li>ShapeImporter.GetDefaultLengthUnit()</li>
<li>ShapeImporter.SetDefaultLengthUnit()</li>
</ul>
<p>get or set the length unit to be used, if not specified in the input SAT file.</p>
<h3><a name="4.6"></a>Worksharing events addition</h3>
<p>Subscribe to the Autodesk.Revit.DB.Events.WorksharedOperationProgressChanged event to be notified when progress has changed during Collaboration for Revit's synchronizing with central operation.</p>
<p>This event consists of several phases. Different event arguments are used during each phase.</p>
<h4><a name="4.6.1"></a>WorksharedOperationProgressChangedEventArgs</h4>
<p>The new class:</p>
<ul>
<li>Autodesk.Revit.DB.Events.WorksharedOperationProgressChangedEventArgs</li>
</ul>
<p>provides a base class for event arguments for worksharing-based progress events.</p>
<h4><a name="4.6.2"></a>DocumentSaveToLocalProgessChangedEventArgs</h4>
<p>The new class:</p>
<ul>
<li>Autodesk.Revit.DB.Events.DocumentSaveToLocalProgessChangedEventArgs provides information during the save to local phase of the DocumentSynchronizingWithCentralProgessChanged event.</li>
</ul>
<p>It has the following properties:</p>
<ul>
<li>DocumentSaveToLocalProgessChangedEventArgs.Location &ndash; Full path of the central model which is to be synchronized.</li>
<li>DocumentSaveToLocalProgessChangedEventArgs.Status &ndash; Gets the API event status, which reflects the current operation execution status.</li>
<li>DocumentSaveToLocalProgessChangedEventArgs.BeforeSaveToCentral &ndash; True if the "save to local" operation is occurring before "save to central"; false if after.</li>
<li>DocumentSaveToLocalProgessChangedEventArgs.FinishedStreams &ndash; The number of streams finished since the last time this event was raised.</li>
<li>DocumentSaveToLocalProgessChangedEventArgs.TotalStreams &ndash; The total expected number of streams to save to local.</li>
<li>DocumentSaveToLocalProgessChangedEventArgs.SaveToLocalFinished &ndash; Indicates if the current "save to local" operation has finished.</li>
</ul>
<h4><a name="4.6.3"></a>DocumentReloadLatestProgressChangedEventArgs</h4>
<p>The new class:</p>
<ul>
<li>Autodesk.Revit.DB.Events.DocumentReloadLatestProgessChangedEventArgs provides information during the reload latest phase of the DocumentSynchronizingWithCentralProgessChanged event.</li>
</ul>
<p>It has the following properties:</p>
<ul>
<li>DocumentReloadLatestProgessChangedEventArgs.Location &ndash; The full path of the central model which is to be synchronized.</li>
<li>DocumentReloadLatestProgessChangedEventArgs.Status &ndash; Gets API event status, reflecting the current operation execution status.</li>
<li>DocumentReloadLatestProgessChangedEventArgs.RetryTimes &ndash; The number of times Revit has tried to Reload Latest. Its value is '0' at the first time.</li>
<li>DocumentReloadLatestProgessChangedEventArgs.DownloadSpeed &ndash; Download speed(bytes/second) in this event.</li>
<li>DocumentReloadLatestProgessChangedEventArgs.FinishedSize &ndash; The downloaded data size, in bytes, since the last time this event was raised.</li>
<li>DocumentReloadLatestProgessChangedEventArgs.TotalSize &ndash; Total expected data size to download, in bytes.</li>
<li>DocumentReloadLatestProgessChangedEventArgs.IsMerging &ndash; Indicates if Revit is merging downloaded data.</li>
<li>DocumentReloadLatestProgessChangedEventArgs.ReloadLatestFinished &ndash; Indicates if current 'reload latest' progress is finished or not.</li>
</ul>
<h4><a name="4.6.4"></a>DocumentSaveToCentralProgessChangedEventArgs</h4>
<p>The new class:</p>
<ul>
<li>Autodesk.Revit.DB.Events.DocumentSaveToCentralProgessChangedEventArgs provides information during the save to central phase of the DocumentSynchronizingWithCentralProgessChanged event.</li>
</ul>
<p>It has the following properties:</p>
<ul>
<li>DocumentSaveToCentralProgessChangedEventArgs.Location &ndash; Full path of the central model which is to be synchronized.</li>
<li>DocumentSaveToCentralProgessChangedEventArgs.Status &ndash; Gets API event status, reflecting the current operation execution status.</li>
<li>DocumentSaveToCentralProgessChangedEventArgs.RetryTimes &ndash; The number of times Revit has tried to Save to Central." Its value is '0' at the first time.</li>
<li>DocumentSaveToCentralProgessChangedEventArgs.UploadSpeed &ndash; Upload speed(bytes/second) of saving to central.</li>
<li>DocumentSaveToCentralProgessChangedEventArgs.FinishedSize &ndash; The uploaded data size, in bytes, since the last time this event was raised.</li>
<li>DocumentSaveToCentralProgessChangedEventArgs.TotalSize &ndash; Total expected uploaded data size to save to central, in bytes.</li>
<li>DocumentSaveToCentralProgessChangedEventArgs.SaveToCentralFinished &ndash; Indicates if current 'save to central' is finished or not.</li>
<li>DocumentSaveToCentralProgessChangedEventArgs.FailureDueToConflicts &ndash; Indicates the 'save to central' failure is caused by submission, that is because another user finished saving to central first.</li>
</ul>
<p>The rest of the document continues with the <a href="http://thebuildingcoder.typepad.com/blog/2016/04/whats-new-in-the-revit-2017-api.html">Revit 2017 API changes</a>.</p>