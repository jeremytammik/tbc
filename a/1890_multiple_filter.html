<p><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="bc.css">
<script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js" type="text/javascript"></script>
</head></p>
<!---

- top_solutioon_authors_two_jeremys_2.png
  top_solutioon_authors_two_jeremys.png

- Multiple Collectors -- multiple filters
  https://forums.autodesk.com/t5/revit-api-forum/multiple-collectors/m-p/10046666

- https://github.com/jeremytammik/RevitLookup/releases/tag/2021.0.0.12

- autotag without overlap
  https://forums.autodesk.com/t5/revit-api-forum/auto-tagging-without-overlap/m-p/10036344/highlight/false#M52915

- https://archi-lab.net/element-tagging-with-dynamo/
  https://forums.autodesk.com/t5/revit-api-forum/tags-without-overlapping/m-p/10040873
  https://forums.autodesk.com/t5/revit-api-forum/auto-tagging-without-overlap/m-p/10036344

- Custom Errors â€“ Preventing Specific Changes to the Revit model
  https://boostyourbim.wordpress.com/2021/01/28/custom-errors-preventing-specific-changes-to-the-revit-model/
  by harrymattison
  Let's say there is a specific list of View Scales that you want allowed in your Revit projects. Or certain naming conventions that should be used. Or something else like that where you'd like to automate the process of checking a user's change and determining if it should be allowed, prevented, or trigger a warning.
  This can be done with two pieces of Revit API functionality - Updater & Custom Failures. You can find all the code here and an explanation in the video below.

- The Unreasonable Ecological Cost of #CryptoArt (and crypto-currencies as well)
  https://memoakten.medium.com/the-unreasonable-ecological-cost-of-cryptoart-2221d3eb2053

twitter:

in the #RevitAPI @AutodeskForge @AutodeskRevit #bim #DynamoBim #ForgeDevCon 

&ndash; 
...

linkedin:

#bim #DynamoBim #ForgeDevCon #Revit #API #IFC #SDK #AI #VisualStudio #Autodesk #AEC #adsk

the [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread

<center>
<img src="img/" alt="" title="" width="600"/>
<p style="font-size: 80%; font-style:italic"></p>
<p style="font-size: 80%; font-style:italic">
<a href=""></a>
</p>
</center>

-->

<h3>Applying Multiple Filters and PostCommand + SendKeys</h3>
<h4><a name="2"></a> Two Jeremys</h4>
<p>Apparently, the user account handling for
the <a href="http://forums.autodesk.com/t5/revit-api-forum/bd-p/160">Revit API discussion forum</a> thread
recently changed.</p>
<p>I can no longer log in with the non-standard Autodesk <code>jeremytammik</code> account that I have been using all these years; the login automatically switches that over to my standard Autodesk <code>jeremy.tammik</code> account with a dot <code>.</code> instead.</p>
<p>As a result, we now have two active Jeremys in the forum:</p>
<p><center>
<img src="img/top_solution_authors_two_jeremys_2.png" alt="Two Jeremys" title="Two Jeremys" width="482"/> <!-- 964 -->
</center></p>
<p>I guess the previous one will fade away as time goes on.</p>
<p>I wish I could meet him in person before he disappears.</p>
<h4><a name="3"></a> Multiple Collectors versus Multiple Filters</h4>
<p>This question arose repeatedly in the past few weeks, so let's reiterate it in detail, prompted by 
the <a href="http://forums.autodesk.com/t5/revit-api-forum/bd-p/160">Revit API discussion forum</a> thread
on <a href="https://forums.autodesk.com/t5/revit-api-forum/multiple-collectors/m-p/10046666">multiple collectors</a></p>
<p><strong>Question:</strong> I noticed that if I create multiple collectors in the same script, they don't work properly and most likely end up empty.
I've tried to use <code>Dispose</code> before creating the second collector to see if it can sort of "reset" the collector, but I always get this error:</p>
<ul>
<li>Exception : Autodesk.Revit.Exceptions.InvalidObjectException: The managed object is not valid.</li>
</ul>
<p>What am I missing?</p>
<p>Here is a simple example where I collect all shared parameters in a project first, so I can use their GUIDs to collect data from them in families.</p>
<pre class="code">
  collector = FilteredElementCollector(doc)

  # Find GUID of desired shared parameters

  sharedPars = collector.OfClass(SharedParameterElement)

  # Collect data from families based on parameter GUID.

  families = collector.OfClass(FamilyInstance)
    .WhereElementIsViewIndependent()
</pre>

<p><strong>Answer:</strong> You are not in fact creating multiple collectors.</p>
<p>You are creating one single collector and applying multiple filters to that.</p>
<p>Applying several different filters to one single collector does exactly what it should:</p>
<p>Every single filter is applied to the collector results.</p>
<p>If the filters are mutually exclusive, you end up with an empty result.</p>
<p>For a previous explanation, please read the discussion
on <a href="https://thebuildingcoder.typepad.com/blog/2019/11/design-automation-api-stacks-collectors-and-links.html#4">reinitialising the filtered element collector</a>.</p>
<p>The same question also came up in a few other recent threads, e.g.,
on <a href="https://forums.autodesk.com/t5/revit-api-forum/how-to-extract-the-geometry-and-the-texts-of-the-title-block-in/m-p/9943738">how to extract the geometry and the texts of the title block in a sheetview</a>,
summarised in the blog post 
on <a href="https://thebuildingcoder.typepad.com/blog/2021/01/sheet-view-xform-coords-img-export-and-title-block.html#2">extracting title block geometry and text</a>.</p>
<p>In your sample code snippet, simply create two separate collectors for shared parameters and family instances.</p>
<p><strong>Response:</strong> I appreciate the reply and support.</p>
<p>I definitely understand what I did wrong now; I can't reuse the same collector variable as the filters just pile up, which obviously causes the collector to be empty, so simple.</p>
<p>It does worry me that after so much research I couldn't find the answer anywhere.</p>
<p><strong>Answer:</strong> Thank you for your appreciation. Happy to hear that the problem is solved and the solution clear and simple.</p>
<p>I'll spell it out in the blog again and hope that will be easier to find in case anyone runs into this again in the future.</p>
<p><center>
<img src="img/rain_water_collector_sheet.jpg" alt="Rain water collector" title="Rain water collector" width="330"/> <!-- 330 -->
</center></p>
<h4><a name="4"></a> RevitLookup Handles Split Region Offsets</h4>
<p>Thanks to Michael <a href="https://github.com/RevitArkitek">@RevitArkitek</a> Coffey, RevitLookup can now handle split region offsets.</p>
<p>He submitted the <a href="https://github.com/jeremytammik/RevitLookup/issues/68">issue #68 &ndash; split region offsets (2021)</a> and a
subsequent <a href="https://github.com/jeremytammik/RevitLookup/pull/69">pull request &ndash; adds handler for <code>GetSplitRegionOffsets</code></a>,
explaining:</p>
<blockquote>
<p>The <code>ViewCropRegionShapeManager</code> method <code>GetSplitRegionOffset</code> was added in 2021.
This returns an <code>XYZ</code> but requires an integer index parameter.
A list of XYZs can be returned, named by the index that was used.</p>
<p>I have this working and can submit a pull request.</p>
</blockquote>
<p>This enhancement is captured
in <a href="https://github.com/jeremytammik/RevitLookup/releases/tag/2021.0.0.12">RevitLookup release 2021.0.0.12</a>.</p>
<p>Many thanks to Michael for implementing and sharing this!</p>
<h4><a name="5"></a> Autotag Without Overlap</h4>
<p>https://forums.autodesk.com/t5/revit-api-forum/auto-tagging-without-overlap/m-p/10036344/highlight/false#M52915</p>
<h4><a name="6"></a> Element Tagging with Dynamo</h4>
<ul>
<li>https://archi-lab.net/element-tagging-with-dynamo/
  https://forums.autodesk.com/t5/revit-api-forum/tags-without-overlapping/m-p/10040873
  https://forums.autodesk.com/t5/revit-api-forum/auto-tagging-without-overlap/m-p/10036344</li>
</ul>
<h4><a name="7"></a> Custom Errors and Preventing Changes</h4>
<p>Harry Mattison presents a nice solution
implementing <a href="https://boostyourbim.wordpress.com/2021/01/28/custom-errors-preventing-specific-changes-to-the-revit-model">custom errors &ndash; preventing specific changes to the Revit model</a>,
explaining:</p>
<blockquote>
<p>Let's say there is a specific list of View Scales that you want allowed in your Revit projects.
Or certain naming conventions that should be used.
Or something else like that where you'd like to automate the process of checking a user's change and determining if it should be allowed, prevented, or trigger a warning.</p>
</blockquote>
<p><center>
<img src="img/hm_custom_error.png" alt="Custom error" title="Custom error" width="600"/> <!-- 705 -->
</center></p>
<blockquote>
<p>This can be achieved with two pieces of Revit API functionality &ndash; Updater and Custom Failures.
You can find all the code here and an explanation in the video below.</p>
</blockquote>
<h4><a name="8"></a> Ecological Cost of Crypto Currency and Art</h4>
<p>I was intrigued and astounded at some of the information shared by Memo Akten in the analysis
of <a href="https://memoakten.medium.com/the-unreasonable-ecological-cost-of-cryptoart-2221d3eb2053">the unreasonable ecological cost of #CryptoArt</a>,
and crypto-currencies as well.</p>