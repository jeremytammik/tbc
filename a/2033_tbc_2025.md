<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="bc.css">
<!-- https://highlightjs.org/#usage
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script>hljs.highlightAll();</script>
-->

<!-- https://prismjs.com -->
<link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
<style> code[class*=language-], pre[class*=language-] { font-size : 90%; } </style>
</head>

<!---

install revit 2025
tbc samples zero warnings no deprecated api usage
remove all deprecated api usage
compile with zero warnings
update visual studio 2022 to 17.9.5
upgrade to .net core
https://duckduckgo.com/?q=upgrade+to+.net+core
updated the seven assembly DLL references:

twitter:

 #RevitAPI @AutodeskRevit #BIM @DynamoBIM

&ndash; ...

linkedin:

#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk

the [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread

<center>
<img src="img/" alt="" title="" width="600"/>
<p style="font-size: 80%; font-style:italic"></p>
</center>

-->

### Migrating The Building Coder Samples

I migrated The Building Coder samples to Revit 2025.

Before starting with the migration per se, I installed Revit 2025 and ensured the comoilation environment is up to date:

Revit 2025
Parallels Desktop 19.3.0
Visual Studio 2022 to 17.9.5

Next, I recompiled The Building Coder samples for Revit 2024 and eliminated al remaining deprecated API useage to ensure zero errors and zero warnings, creating a final
[release 2024.0.153.1](https://github.com/jeremytammik/the_building_coder_samples/releases/tag/2024.0.153.1) for that.

I used the [.NET Upgrade Assistant](https://learn.microsoft.com/en-us/dotnet/core/porting/upgrade-assistant-overview) to move from the .NET Framework 4.8 to .NET Core 8:

<center>
<img src="img/tbc2025upgrade_01.png" alt=".NET Upgrade Assistant" title=".NET Upgrade Assistant" width="600"/> <!-- Pixel Height: 678 Pixel Width: 848 -->
<p style="font-size: 80%; font-style:italic">.NET Upgrade Assistant</p>
<img src="img/tbc2025upgrade_02.png" alt="Upgrade assistant target" title="Upgrade assistant target" width="600"/> <!-- Pixel Height: 1,092 Pixel Width: 844 -->
<p style="font-size: 80%; font-style:italic">Upgrade assistant target</p>
<img src="img/tbc2025upgrade_03.png" alt="Upgrade assistant components" title="Upgrade assistant components" width="600"/> <!-- Pixel Height: 678 Pixel Width: 848 -->
<p style="font-size: 80%; font-style:italic">Upgrade assistant components</p>
<img src="img/tbc2025upgrade_04.png" alt="Upgrade assistant result" title="Upgrade assistant result" width="600"/> <!-- Pixel Height: 1,360 Pixel Width: 840 -->
<p style="font-size: 80%; font-style:italic">Upgrade assistant result</p>
</center>

It successfully upgraded almost everything.

However, the seven Revit 2024 API assemblies cannot be upgraded, since they are hardwired for the .NET Framework 4.8:

- AdWindows
- RevitAPI
- RevitAPIIFC
- RevitAPIMacros
- RevitAPIUl
- RevitAPIUIMacros
- UlFrameworkServices

They need to be manually redefined to use the Revit 2025 API assemblies instead:


####<a name="2"></a>

<pre><code class="language-xml">
</code></pre>




12 errors, 2 warnings
/Users/jta/a/doc/revit/tbc/git/a/doc/tbc_samples_2025_migr_01.txt

Error CS0104  'TaskDialog' is an ambiguous reference between 'System.Windows.Forms.TaskDialog' and 'Autodesk.Revit.UI.TaskDialog' BuildingCoder Y:\a\src\rvt\the_building_coder_samples\BuildingCoder\CmdCollectorPerformance.cs  289 Active
Error CS0104  'TaskDialog' is an ambiguous reference between 'System.Windows.Forms.TaskDialog' and 'Autodesk.Revit.UI.TaskDialog' BuildingCoder Y:\a\src\rvt\the_building_coder_samples\BuildingCoder\CmdCloseDocument.cs 127 Active
Error CS0104  'TaskDialog' is an ambiguous reference between 'System.Windows.Forms.TaskDialog' and 'Autodesk.Revit.UI.TaskDialog' BuildingCoder Y:\a\src\rvt\the_building_coder_samples\BuildingCoder\CmdCollectorPerformance.cs  204 Active
Error CS0104  'TaskDialog' is an ambiguous reference between 'System.Windows.Forms.TaskDialog' and 'Autodesk.Revit.UI.TaskDialog' BuildingCoder Y:\a\src\rvt\the_building_coder_samples\BuildingCoder\CmdCollectorPerformance.cs  940 Active
Error CS0104  'TaskDialog' is an ambiguous reference between 'System.Windows.Forms.TaskDialog' and 'Autodesk.Revit.UI.TaskDialog' BuildingCoder Y:\a\src\rvt\the_building_coder_samples\BuildingCoder\CmdCollectorPerformance.cs  2283  Active
Error CS0104  'TaskDialog' is an ambiguous reference between 'System.Windows.Forms.TaskDialog' and 'Autodesk.Revit.UI.TaskDialog' BuildingCoder Y:\a\src\rvt\the_building_coder_samples\BuildingCoder\CmdCollectorPerformance.cs  2298  Active
Error CS0104  'TaskDialog' is an ambiguous reference between 'System.Windows.Forms.TaskDialog' and 'Autodesk.Revit.UI.TaskDialog' BuildingCoder Y:\a\src\rvt\the_building_coder_samples\BuildingCoder\CmdCollectorPerformance.cs  2307  Active
Error CS0104  'TaskDialog' is an ambiguous reference between 'System.Windows.Forms.TaskDialog' and 'Autodesk.Revit.UI.TaskDialog' BuildingCoder Y:\a\src\rvt\the_building_coder_samples\BuildingCoder\CmdCollectorPerformance.cs  2315  Active
Error CS1503  Argument 1: cannot convert from 'Autodesk.Revit.UI.UIDocument' to 'Autodesk.Revit.UI.UIApplication' BuildingCoder Y:\a\src\rvt\the_building_coder_samples\BuildingCoder\CmdDeleteMacros.cs  43  Active
Error CS1503  Argument 1: cannot convert from 'Autodesk.Revit.DB.Document' to 'Autodesk.Revit.ApplicationServices.Application'  BuildingCoder Y:\a\src\rvt\the_building_coder_samples\BuildingCoder\CmdDeleteMacros.cs  74  Active
Error CS1061  'MacroModule' does not contain a definition for 'RemoveMacro' and no accessible extension method 'RemoveMacro' accepting a first argument of type 'MacroModule' could be found (are you missing a using directive or an assembly reference?)  BuildingCoder Y:\a\src\rvt\the_building_coder_samples\BuildingCoder\CmdDeleteMacros.cs  88  Active
Error CS0104  'TaskDialog' is an ambiguous reference between 'System.Windows.Forms.TaskDialog' and 'Autodesk.Revit.UI.TaskDialog' BuildingCoder Y:\a\src\rvt\the_building_coder_samples\BuildingCoder\CmdPlaceFamilyInstance.cs 98  Active
Warning CS8073  The result of the expression is always 'true' since a value of type 'Guid' is never equal to 'null' of type 'Guid?' BuildingCoder Y:\a\src\rvt\the_building_coder_samples\BuildingCoder\CmdFamilyParamGuid.cs 94  Active
Warning CS8073  The result of the expression is always 'true' since a value of type 'Guid' is never equal to 'null' of type 'Guid?' BuildingCoder Y:\a\src\rvt\the_building_coder_samples\BuildingCoder\CmdProjectParameterGuids.cs 483 Active

removed TaskDialog ambiguity

removed support for document-level macros

removed comparison of Parameter.GUID property with null

updated BcSamples.txt with new binary output path */bin/Debug/net8.0-windows*

