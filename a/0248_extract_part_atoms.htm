<head>
<link rel="stylesheet" type="text/css" href="bc.css">
</head>

<h3>Extract Part Atoms</h3>

<p>Last week, we discussed how to use the Revit API to 

<a href="http://thebuildingcoder.typepad.com/blog/2009/11/family-parameter-value.html">
read the values of family parameters</a>.

<p>Another quick way to access all non-empty parameter values in a family file and see some other interesting family data as well is to simply make a call to the Application.ExtractPartAtomFromFamilyFile method.

<p>It is mentioned in the What's New section of the Revit 2010 API help file.
Its purpose is to export family data to XML for integration with Autodesk Seek.
It opens an existing family file on disk and creates an XML file with data used by Autodesk Seek for content search.
It takes two string arguments, the family file path and the path of an XML file to be generated.
If there is a TXT type catalogue next to the family file (a TXT file with the same name as the RFA file), it will read that as well and process its contents into part atoms.
The usage is simple:

<pre class="code">
<span class="blue">if</span>( doc.IsFamilyDocument )
{
&nbsp; <span class="blue">string</span> path = doc.PathName;
&nbsp; <span class="blue">if</span>( 0 &lt; path.Length )
&nbsp; {
&nbsp; &nbsp; app.ExtractPartAtomFromFamilyFile(
&nbsp; &nbsp; &nbsp; path, path + <span class="maroon">&quot;.xml&quot;</span> );
&nbsp; }
}
</pre>

<p>I used the same simple column family generated by the 

<a href="http://thebuildingcoder.typepad.com/blog/2009/10/revit-family-creation-api-labs.html">
Family API Lab 4</a> 

command which we used to examine the 

<a href="http://thebuildingcoder.typepad.com/blog/2009/11/family-parameter-value.html">
family parameter values</a>, 

saved it to a file named 'column.rfa', and ran the code shown above to generate 'column.rfa.xml' with the following content:

<pre>
<span class="blue">&lt;?</span><span class="maroon">xml</span><span class="blue"> </span><span class="red">version</span><span class="blue">=</span>&quot;<span class="blue">1.0</span>&quot;<span class="blue"> </span><span class="red">encoding</span><span class="blue">=</span>&quot;<span class="blue">UTF-8</span>&quot;<span class="blue">?&gt;</span>
<span class="blue">&lt;</span><span class="maroon">entry</span><span class="blue"> </span><span class="red">xmlns</span><span class="blue">=</span>&quot;<span class="blue">http://www.w3.org/2005/Atom</span>&quot;<span class="blue"> </span><span class="red">xmlns:A</span><span class="blue">=</span>&quot;<span class="blue">urn:schemas-autodesk-com:partatom</span>&quot;<span class="blue">&gt;</span>
<span class="blue">&nbsp; &lt;</span><span class="maroon">title</span><span class="blue">&gt;</span>column<span class="blue">&lt;/</span><span class="maroon">title</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &lt;</span><span class="maroon">id</span><span class="blue">&gt;&lt;/</span><span class="maroon">id</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &lt;</span><span class="maroon">updated</span><span class="blue">&gt;</span>2009-11-11T08:12:08Z<span class="blue">&lt;/</span><span class="maroon">updated</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &lt;</span><span class="maroon">A:taxonomy</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &lt;</span><span class="maroon">term</span><span class="blue">&gt;</span>adsk:revit<span class="blue">&lt;/</span><span class="maroon">term</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &lt;</span><span class="maroon">label</span><span class="blue">&gt;</span>Autodesk Revit<span class="blue">&lt;/</span><span class="maroon">label</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &lt;/</span><span class="maroon">A:taxonomy</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &lt;</span><span class="maroon">A:taxonomy</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &lt;</span><span class="maroon">term</span><span class="blue">&gt;</span>adsk:revit:grouping<span class="blue">&lt;/</span><span class="maroon">term</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &lt;</span><span class="maroon">label</span><span class="blue">&gt;</span>Autodesk Revit Grouping<span class="blue">&lt;/</span><span class="maroon">label</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &lt;/</span><span class="maroon">A:taxonomy</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &lt;</span><span class="maroon">category</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &lt;</span><span class="maroon">term</span><span class="blue">&gt;</span>23.25.30.11.14.11<span class="blue">&lt;/</span><span class="maroon">term</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &lt;</span><span class="maroon">scheme</span><span class="blue">&gt;</span>std:oc1<span class="blue">&lt;/</span><span class="maroon">scheme</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &lt;/</span><span class="maroon">category</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &lt;</span><span class="maroon">category</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &lt;</span><span class="maroon">term</span><span class="blue">&gt;</span>Columns<span class="blue">&lt;/</span><span class="maroon">term</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &lt;</span><span class="maroon">scheme</span><span class="blue">&gt;</span>adsk:revit:grouping<span class="blue">&lt;/</span><span class="maroon">scheme</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &lt;/</span><span class="maroon">category</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &lt;</span><span class="maroon">link</span><span class="blue"> </span><span class="red">rel</span><span class="blue">=</span>&quot;<span class="blue">design-2d</span>&quot;<span class="blue"> </span><span class="red">type</span><span class="blue">=</span>&quot;<span class="blue">application/rfa</span>&quot;<span class="blue"> </span><span class="red">href</span><span class="blue">=</span>&quot;<span class="blue">.</span>&quot;<span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &lt;</span><span class="maroon">A:design-file</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &nbsp; &lt;</span><span class="maroon">A:title</span><span class="blue">&gt;</span>column.rfa<span class="blue">&lt;/</span><span class="maroon">A:title</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &nbsp; &lt;</span><span class="maroon">A:product</span><span class="blue">&gt;</span>Revit<span class="blue">&lt;/</span><span class="maroon">A:product</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &nbsp; &lt;</span><span class="maroon">A:product-version</span><span class="blue">&gt;</span>2010 or later one<span class="blue">&lt;/</span><span class="maroon">A:product-version</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &nbsp; &lt;</span><span class="maroon">A:updated</span><span class="blue">&gt;</span>2009-11-11T08:12:08Z<span class="blue">&lt;/</span><span class="maroon">A:updated</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &lt;/</span><span class="maroon">A:design-file</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &lt;/</span><span class="maroon">link</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &lt;</span><span class="maroon">A:family</span><span class="blue"> </span><span class="red">type</span><span class="blue">=</span>&quot;<span class="blue">user</span>&quot;<span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &lt;</span><span class="maroon">A:variationCount</span><span class="blue">&gt;</span>4<span class="blue">&lt;/</span><span class="maroon">A:variationCount</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &lt;</span><span class="maroon">A:part</span><span class="blue"> </span><span class="red">type</span><span class="blue">=</span>&quot;<span class="blue">user</span>&quot;<span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &nbsp; &lt;</span><span class="maroon">title</span><span class="blue">&gt;</span>600x900<span class="blue">&lt;/</span><span class="maroon">title</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &nbsp; &lt;</span><span class="maroon">Tw</span><span class="blue"> </span><span class="red">units</span><span class="blue">=</span>&quot;<span class="blue">mm</span>&quot;<span class="blue">&gt;</span>150<span class="blue">&lt;/</span><span class="maroon">Tw</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &nbsp; &lt;</span><span class="maroon">Td</span><span class="blue"> </span><span class="red">units</span><span class="blue">=</span>&quot;<span class="blue">mm</span>&quot;<span class="blue">&gt;</span>225<span class="blue">&lt;/</span><span class="maroon">Td</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &nbsp; &lt;</span><span class="maroon">Depth</span><span class="blue"> </span><span class="red">units</span><span class="blue">=</span>&quot;<span class="blue">mm</span>&quot;<span class="blue">&gt;</span>900<span class="blue">&lt;/</span><span class="maroon">Depth</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &nbsp; &lt;</span><span class="maroon">Width</span><span class="blue"> </span><span class="red">units</span><span class="blue">=</span>&quot;<span class="blue">mm</span>&quot;<span class="blue">&gt;</span>600<span class="blue">&lt;/</span><span class="maroon">Width</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &lt;/</span><span class="maroon">A:part</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &lt;</span><span class="maroon">A:part</span><span class="blue"> </span><span class="red">type</span><span class="blue">=</span>&quot;<span class="blue">user</span>&quot;<span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &nbsp; &lt;</span><span class="maroon">title</span><span class="blue">&gt;</span>1000x300<span class="blue">&lt;/</span><span class="maroon">title</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &nbsp; &lt;</span><span class="maroon">Tw</span><span class="blue"> </span><span class="red">units</span><span class="blue">=</span>&quot;<span class="blue">mm</span>&quot;<span class="blue">&gt;</span>250<span class="blue">&lt;/</span><span class="maroon">Tw</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &nbsp; &lt;</span><span class="maroon">Td</span><span class="blue"> </span><span class="red">units</span><span class="blue">=</span>&quot;<span class="blue">mm</span>&quot;<span class="blue">&gt;</span>75<span class="blue">&lt;/</span><span class="maroon">Td</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &nbsp; &lt;</span><span class="maroon">Depth</span><span class="blue"> </span><span class="red">units</span><span class="blue">=</span>&quot;<span class="blue">mm</span>&quot;<span class="blue">&gt;</span>300<span class="blue">&lt;/</span><span class="maroon">Depth</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &nbsp; &lt;</span><span class="maroon">Width</span><span class="blue"> </span><span class="red">units</span><span class="blue">=</span>&quot;<span class="blue">mm</span>&quot;<span class="blue">&gt;</span>1000<span class="blue">&lt;/</span><span class="maroon">Width</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &lt;/</span><span class="maroon">A:part</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &lt;</span><span class="maroon">A:part</span><span class="blue"> </span><span class="red">type</span><span class="blue">=</span>&quot;<span class="blue">user</span>&quot;<span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &nbsp; &lt;</span><span class="maroon">title</span><span class="blue">&gt;</span>600x600<span class="blue">&lt;/</span><span class="maroon">title</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &nbsp; &lt;</span><span class="maroon">Tw</span><span class="blue"> </span><span class="red">units</span><span class="blue">=</span>&quot;<span class="blue">mm</span>&quot;<span class="blue">&gt;</span>150<span class="blue">&lt;/</span><span class="maroon">Tw</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &nbsp; &lt;</span><span class="maroon">Td</span><span class="blue"> </span><span class="red">units</span><span class="blue">=</span>&quot;<span class="blue">mm</span>&quot;<span class="blue">&gt;</span>150<span class="blue">&lt;/</span><span class="maroon">Td</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &nbsp; &lt;</span><span class="maroon">Depth</span><span class="blue"> </span><span class="red">units</span><span class="blue">=</span>&quot;<span class="blue">mm</span>&quot;<span class="blue">&gt;</span>600<span class="blue">&lt;/</span><span class="maroon">Depth</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &nbsp; &lt;</span><span class="maroon">Width</span><span class="blue"> </span><span class="red">units</span><span class="blue">=</span>&quot;<span class="blue">mm</span>&quot;<span class="blue">&gt;</span>600<span class="blue">&lt;/</span><span class="maroon">Width</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &lt;/</span><span class="maroon">A:part</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &lt;</span><span class="maroon">A:part</span><span class="blue"> </span><span class="red">type</span><span class="blue">=</span>&quot;<span class="blue">user</span>&quot;<span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &nbsp; &lt;</span><span class="maroon">title</span><span class="blue">&gt;</span>Glass<span class="blue">&lt;/</span><span class="maroon">title</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &nbsp; &lt;</span><span class="maroon">Tw</span><span class="blue"> </span><span class="red">units</span><span class="blue">=</span>&quot;<span class="blue">mm</span>&quot;<span class="blue">&gt;</span>150<span class="blue">&lt;/</span><span class="maroon">Tw</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &nbsp; &lt;</span><span class="maroon">Td</span><span class="blue"> </span><span class="red">units</span><span class="blue">=</span>&quot;<span class="blue">mm</span>&quot;<span class="blue">&gt;</span>150<span class="blue">&lt;/</span><span class="maroon">Td</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &nbsp; &lt;</span><span class="maroon">Depth</span><span class="blue"> </span><span class="red">units</span><span class="blue">=</span>&quot;<span class="blue">mm</span>&quot;<span class="blue">&gt;</span>600<span class="blue">&lt;/</span><span class="maroon">Depth</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &nbsp; &lt;</span><span class="maroon">Width</span><span class="blue"> </span><span class="red">units</span><span class="blue">=</span>&quot;<span class="blue">mm</span>&quot;<span class="blue">&gt;</span>600<span class="blue">&lt;/</span><span class="maroon">Width</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &nbsp; &lt;/</span><span class="maroon">A:part</span><span class="blue">&gt;</span>
<span class="blue">&nbsp; &lt;/</span><span class="maroon">A:family</span><span class="blue">&gt;</span>
<span class="blue">&lt;/</span><span class="maroon">entry</span><span class="blue">&gt;</span>
</pre>

<p>You can see the same four types with the same parameter values listed.
The unnamed type is skipped, as well as empty parameter values.
I also note that the ColumnFinish material parameter does not appear here.
