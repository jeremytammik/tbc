<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="bc.css">
<!-- https://highlightjs.org/#usage
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script>hljs.highlightAll();</script>
-->

<!-- https://prismjs.com -->
<link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
<style> code[class*=language-], pre[class*=language-] { font-size : 90%; } </style>
</head>

<!---

- sync RevitSdkSamples from 2024 to 2025


twitter:

 the #RevitAPI @AutodeskRevit #BIM @DynamoBIM

&ndash; ...

linkedin:

#BIM #DynamoBIM #AutodeskAPS #Revit #API #IFC #SDK #Autodesk #AEC #adsk

the [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread

<center>
<img src="img/" alt="" title="" width="600"/>
<p style="font-size: 80%; font-style:italic"></p>
</center>

-->

### The Revit 2025 SDK

####<a name="2"></a> The Revit 2025 SDK

I installed the Revit 2025 SDK and performed the following steps:

- [Comparison with previous SDK](#3)
- Integration into [RevitSdkSamples](https://github.com/jeremytammik/RevitSdkSamples)
- Compile in Visual Studio

####<a name="3"></a> Comparison with Previous SDK

Comparing the directory structure with the Revit 2024 SDK, I note the following changes:

Removed:

- REX SDK
- Samples/AnalyticalSupportData_Info
- Samples/CreateTrianglesTopography
- Samples/Site

Modified:

- Macro Samples/GetTimeElapsed &ndash; previously separate samples and directories for CSharp and VBNet

Added:

- Macro Samples/MacroSamples_MEP
- Macro Samples/MacroSamples_RFA
- Macro Samples/MacroSamples_RVT
- Samples/ContextMenu &ndash; create a customised add-in context menu
- Samples/DisallowEndWrapping &ndash; allow or disallow end wrapping at certain wall locations
- Samples/EditSketch &ndash; edit curves in sketches and add dimensions to the sketch using `SketchEditScope`
- Samples/NewMacro &ndash; generate, build end execute a Macro by `MacroManager`

Here are the exact comparison steps and details:

- [Comparison steps and commands](doc/2025_revt_sdk_sample_comparison.txt)
- [Directory differences](doc/2025_dir_diff.txt)
- [File differences](doc/2025_file_diff.txt)

####<a name="4"></a> Integration into RevitSdkSamples

In order to preserve the RevitSdkSamples Git history from the previous version to the Revit 2025 SDK as much as possible, I integrated the new SDK into RevitSdkSamples in two steps, based on the differences detected in the steps described above:

- Delete from RevitSdkSamples all obsolete files that no longer occur in the Revit 2025 SDK
- Copy the Revit 2025 SDK into RevitSdkSamples, overwriting existing files

The result is captured in [RevitSdkSamples release 2025.0.0](https://github.com/jeremytammik/RevitSdkSamples/releases/tag/2025.0.0).

####<a name="5"></a> Compiling the Revit 2025 SDK Samples

My first attempt to rebuild the solution [skipped all 201 solutions](doc/sdk_samples_2025_01.txt).

I searched for an explanation and looked
at [how to determine why Visual Studio might be skipping projects when building a solution](https://stackoverflow.com/questions/1319772/how-to-determine-why-visual-studio-might-be-skipping-projects-when-building-a-so).

I ended up selecting the build target `x64` in the Configuration Manager to match the targets listed for each one of the individual solutions.

<center>
<img src="img/sdk_2025_vs_config_mgr.png" alt="Configuration Manager build target" title="Configuration Manager build target" width="100"/> <!-- Pixel Height: 678 Pixel Width: 848 -->
<p style="font-size: 80%; font-style:italic">Configuration Manager build target</p>
</center>

With that setting in place, it reported 'Rebuild started at 9:09 AM...' and did not skip the projects, but it did not seem to do anything else either except endlessly consume more and more memory until
I [canceled the build after more than 15 minutes](doc/sdk_samples_2025_02.txt):

<center>
<img src="img/sdk_2025_vs_memory.png" alt="Visual Studio memory consumption growing" title="Visual Studio memory consumption growing" width="100"/> <!-- Pixel Height: 678 Pixel Width: 848 -->
<p style="font-size: 80%; font-style:italic">Visual Studio memory consumption growing</p>
</center>

Next, I removed the `.vs` folder and changed the build output verbosity to detailed in Visual Studio &gt; Tools &gt; Options &gt; Projects and Solutions &gt; Build and Run.

The increased verbosity still gives no information about what is happening, beyond the message saying 'Rebuild started at 9:46 AM...'

Although... the status bar does list one project after another, reporting 'Restored ...csproj in 3.05 s'.
Multiplying 200 projects by 2 seconds each should still complete in a manageable time, though, but I see no hint of progress.

Switching the output to 'Package Manager' shows what is going on...
[Generating MSBuild file, Writing cache file to disk, Persisting dg, Writing assets file to disk etc.](doc/sdk_samples_2025_03.txt)...
half an hour waiting and still going... completed after 34 minutes!

I am probably running a suboptimal setup here...

So, I continued waiting.
After 1 hour and 46 minutes, the compilation completed, partially,
with [177 succeeded, 24 failed, 0 skipped, 30 errors and 5 warnings](doc/sdk_samples_2025_04.txt).

A new record time, slower than all previous versions by a factor of about 25.

Looking at the error list, two errors are caused by code in ExternalResourceDBServer:

- Error CS0246 The type or namespace names `GetLinkPathForOpen` and `LocalLinkSharedCoordinatesSaved` could not be found

I fixed those by commenting out the two offending lines, since the methods referred to are not defined anywhere.

The remaining errors and warnings have to do with external referces, such as:

- Error NU1100  Unable to resolve 'System.Data.DataSetExtensions (>= 4.5.0)' for 'net8.0-windows7.0' in Selections
- Error BC30002 Type 'MsExcel.Application' is not defined in `ArchSample` and `FireRating`
- Warning BC40056 Namespace or type specified in the Imports 'Microsoft.Office.Interop.Excel' doesn't contain any public member or cannot be found in `ArchSample` and `FireRating`
- Error NU1100  Unable to resolve 'Microsoft.CSharp (>= 4.7.0)' for 'net8.0-windows7.0' in `UpdateExternallyTaggedBRep`, `BRepBuilderExample`, `ReadonlySharedParameters`, `ExtensibleStorageUtility`
- Error NU1100  Unable to resolve 'Newtonsoft.Json (>= 13.0.1)' for 'net8.0-windows7.0' in `CloudAPISample`
- Error NU1100  Unable to resolve 'System.Data.DataSetExtensions (>= 4.5.0)' for 'net8.0-windows7.0' in `ReadonlySharedParameters`, `ExtensibleStorageUtility`, `ExternalCommandRegistration` and a dozen other projects
- Error NU1100  Unable to resolve 'HtmlTextWriter (>= 2.1.1)' for 'net8.0-windows7.0' in ScheduleToHTML
- Error NU1100  Unable to resolve 'System.Net.Http (>= 4.3.4)' for 'net8.0-windows7.0' in ScheduleToHTML
- Error NU1100  Unable to resolve 'System.Data.OleDb (>= 8.0.0)' for 'net8.0-windows7.0' in RoomSchedule
- Warning MSB3284 Cannot get the file path for type library "00020813-0000-0000-c000-000000000046" version 1.9 in FireRating and ArchSample

Possibly, some of these errors are caused by not installing Microsoft Office in my virtual machine, so I went ahead and installed Microsoft Office.

I noticed this message in the build output window:

- To prevent NuGet from restoring packages during build, open the Visual Studio Options dialog, click on the NuGet Package Manager node and uncheck 'Allow NuGet to download missing packages during build.'

Another possible culprit
explaining [why Visual Studio keeps rebuilding my projects for no good reason](https://michaelscodingspot.com/visual-studio-keeps-rebuilding-projects-no-good-reason/):

> Resource is set to “Copy always”:
Copy always means just what it says, and there’s never a good reason for that.
There is another option to "Copy if newer" instead of “Copy always”.

In the newer SDK-style projects, go to the `.csproj` file and look for

<pre><code class="language-xml">
&lt;CopyToOutputDirectory&gt;Always&lt;/CopyToOutputDirectory&gt;
</code></pre>

Change that to

<pre><code class="language-xml">
&lt;CopyToOutputDirectory&gt;PreserveNewest&lt;/CopyToOutputDirectory&gt;
</code></pre>

I found and fixed that setting in six project: CloudAPISample, DockableDialogs, FreeFormElement, GetSetDefaultTypes, InCanvasControlAPI and SinePlotter.

Recompiling again from scratch resulted in [181 succeeded, 20 failed, 23 errors, 5 warnings, in 1 hour and 26 minutes](doc/sdk_samples_2025_06.txt).

Definitely not something I want to repeat on a daily basis.

####<a name="5"></a> Context Menu

As hinted at by the new `ContextMenu` SDK sample mentioned above, the Revit API 2025 enables an add-in to create a custom right-click context menu:

> This sample demonstrates how to create customized context menu for Add-In and how to create different types of menu items: `CommandMenuItem`, `SeparatorItem`, `SubMenuItem`.

Ricaun shares his take on that functionality in
his [ContextMenuExtension gist](https://gist.github.com/ricaun/ffb897b9ba5b152992cfe20ca6bcfa16) and
a nine-minute video
on [Revit API 2025 RegisterContextMenu](https://youtu.be/1hqGWeYjUcU):

<center>
<iframe width="480" height="270" src="https://www.youtube.com/embed/1hqGWeYjUcU?si=92qAe9HEPDd4Kr_X" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
</center>

